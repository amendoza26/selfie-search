<div class="m-[10px] space-y-2">
  <div style="display: flex; justify-content: space-between;">
    <div class="text-3xl text-primary font-extrabold">Reportería de Mediciones</div>
  </div>
  <div class="flex items-center bg-white p-5 rounded-[22px] text-primary font-bold space-x-12">
    <div class="flex flex-col">
      <mat-label>Desde</mat-label>
      <mat-form-field appearance="outline">
        <input matInput [matDatepicker]="picker1" [(ngModel)]="dateFrom">
        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
        <mat-datepicker #picker1></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="flex flex-col">
      <mat-label>Hasta</mat-label>
      <mat-form-field appearance="outline" >
        <input matInput [matDatepicker]="picker2" [(ngModel)]="dateTo">
        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
        <mat-datepicker #picker2></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="flex flex-col items-center">
      <mat-label></mat-label>
      <button class="text-white bg-[#CF095E] px-5 py-2 rounded-full text-[15px]" (click)="applyDateRangeFilter()">Buscar</button>
    </div>
  </div>

  <!-- tabla  -->
  <div class="">

    <div class="p-4 bg-white space-y-8">

      <div class="flex space-x-2 justify-between">
        <div class="platform-wrapper flex space-x-1 relative items-center">
          <mat-label>Mostrar</mat-label>
          <mat-form-field appearance="outline" style="width: 50px">
            <mat-select [(value)]="pageSize" (selectionChange)="changePageSize($event.value)">
              <mat-option *ngFor="let size of pageSizeOptions" [value]="size">
                {{ size }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mat-label>registros</mat-label>
        </div>
        <div class="platform-wrapper flex relative items-center">
          <mat-label>Cliente</mat-label>
          <mat-form-field appearance="outline" style="width: 250px;">

            <!-- INPUT FAKE -->
            <input
              matInput
              readonly
              [value]="selectedPlatform || ''"
              placeholder="Seleccionar plataforma"
              (click)="showPlatformList = !showPlatformList">

            <!-- Ícono -->
            <button matSuffix mat-icon-button (click)="toggleDropdown()">
              <mat-icon>expand_more</mat-icon>
            </button>
          </mat-form-field>

          <!-- LISTA -->
          <div
            *ngIf="showPlatformList"
            class="absolute left-0 top-full mt-1 bg-white border border-gray-200
            rounded-xl shadow-md w-full max-h-60 overflow-auto z-[9999]">

            <div
              *ngFor="let p of platforms"
              (click)="selectPlatform(p)"
              class="px-4 py-2 hover:bg-gray-100 cursor-pointer">
              {{ p }}
            </div>
          </div>
        </div>

        <div class="platform-wrapper flex relative items-center">
          <mat-label>Cupon</mat-label>
          <mat-form-field appearance="outline" style="width: 250px;">

            <!-- INPUT FAKE -->
            <input
              matInput
              readonly
              [value]="selectedCupon || ''"
              placeholder="Seleccionar cupon"
              (click)="showCuponList = !showCuponList">

            <!-- Ícono -->
            <button matSuffix mat-icon-button (click)="toggleCuponDropdown()">
              <mat-icon>expand_more</mat-icon>
            </button>
          </mat-form-field>

          <!-- LISTA -->
          <div
            *ngIf="showCuponList"
            class="absolute left-0 top-full mt-1 bg-white border border-gray-200
            rounded-xl shadow-md w-full max-h-60 overflow-auto z-[9999]">

            <div
              *ngFor="let c of cupons"
              (click)="selectCupon(c)"
              class="px-4 py-2 hover:bg-gray-100 cursor-pointer">
              {{ c }}
            </div>
          </div>
        </div>

        <div class="flex items-center">
          <mat-form-field appearance="outline" style="width: 100%">
            <input matInput (keyup)="applyFilter($event)" placeholder="Buscar...">
          </mat-form-field>
        </div>
      </div>

      <div style="overflow: auto;">
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8" style="width: 100%;">
          <ng-container *ngFor="let column of displayedColumns" [matColumnDef]="column">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>
              {{ columnHeaders[column] }}
            </th>

            <td mat-cell *matCellDef="let element" style="font-size:12px">
              {{ column === 'med_fechreg' ? formatDateToLocal(element[column]) : element[column] }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>

      <mat-paginator
        hidePageSize="true"
        showFirstLastButtons
        pageSize="10"
>
      </mat-paginator>
    </div>

  </div>
</div>

